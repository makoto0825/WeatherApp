<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClothesPage</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="..\css\clothes.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200..900&family=Mochiy+Pop+One"
    />
  </head>

  <body>
    <header class="header">
      <input type="checkbox" class="sp_nav_trigger" id="sp_nav_trigger" />
      <label for="sp_nav_trigger">
        <span></span>
      </label>
      <nav class="navbar">
        <a class="navbar_home" href="./index.html">WeatherApp</a>
        <ul class="navbar_menu">
          <li class="navbar_item">
            <a href="./about.html" class="navbar_link">About</a>
          </li>
          <li class="navbar_item">
            <a href="./detailed_weather.html" class="navbar_link">Weather</a>
          </li>
          <li class="navbar_item">
            <a href="./clothes.html" class="navbar_link current">Clothes</a>
          </li>
          <li class="navbar_item">
            <a href="./settings.html" class="navbar_link">Settings</a>
          </li>
          <li class="navbar_item">
            <a href="./welcome.html" class="navbar_link">Welcome</a>
          </li>
        </ul>
      </nav>
    </header>
    <h1 class="fontMochiy-pop">Clothes Recommendation</h1>
    <div class="content">
      <h2 class=".fontMochiy-pop" id="today"></h2>
      <div>
        <img id="clothesImg" src="../images/clothes/冬服.png" alt="clothes" />
      </div>
      <img id="weatherImage"  alt="weather" />
      <p class="fontPoppins text">
        Choose a waterproof coat, insulated gloves, and a warm hat to combat the
        chilly weather. Opt for waterproof boots and insulated socks for
        footwear, and layer clothing for temperature control. Use a scarf or
        neck warmer to shield your face and neck from the cold wind.
      </p>
      <div class="slide_switch switch">
        <span class="switch_text">M</span>
        <label class="switch_button">
          <input type="checkbox" class="switch_checkbox" />
          <span class="switch_slider"></span>
        </label>
        <span class="switch_text">F</span>
      </div>
    </div>
    <footer class="footer">
      <p>&copy;WeatherApp</p>
    </footer>
  </body>
  <script>
      //今日の日付を取得する関数:フォーマット例「January 1」
      function getToday() {
        const today = new Date();
        const month = today.getMonth() + 1;
        const date = today.getDate();
        const day = today.getDay();
        const monthName = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];
        const monthStr = monthName[month - 1];
        console.log(monthStr);
        const todayDate = `${monthStr} ${date}`;
        return todayDate;
      }
      //天気の情報を取得する関数
      async function getWeather() {
        const URL ="https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&daily=weather_code,temperature_2m_max,temperature_2m_min";
        try {
          const response = await fetch(URL);
          if (!response.ok) {
            throw new Error("Failed to fetch weather data");//APIの情報を取得できなかった場合はエラーメッセージを表示する
          }
          const json = await response.json();
          return json;
        } catch (error) {
          console.error(error);//何かしらのエラーが発生した場合はエラーメッセージを表示する
        }
      }
      //現在の日付を表示する
      const todayDom = document.getElementById("today");
      todayDom.innerHTML = getToday();
      //天気のアイコンを表示する
      const WeatherIconObj = {
        0: "Clear",
        1: "Clear",
        2: "Cloudy",
        3: "Cloudy",
        45: "Fog",
        48: "Fog",
        51: "Drizzle",
        53: "Drizzle",
        55: "Drizzle",
        56: "Drizzle",
        57: "Drizzle",
        61: "Rain",
        63: "Rain",
        65: "Rain",
        66: "Rain",
        67: "Rain",
        71: "Snow",
        73: "Snow",
        75: "Snow",
        80: "Snow",
        81: "Rain showers",
        82: "Rain showers",
        85: "Snow shower",
        86: "Snow shower",
        95: "Thunderstorm",
        96: "Thunderstorm with hail",
        99: "Thunderstorm with hail",
      };
      (async () => {
        const WeatherInfo = await getWeather();
        const todayWeather =WeatherInfo.daily.weather_code[0];
        //todayWeatherの値によって表示する画像を変更する
        const weatherImageName = WeatherIconObj[todayWeather];
        console.log(weatherImageName);
        const weatherImageElement = document.getElementById("weatherImage");
        // 画像のパスを設定
        weatherImageElement.src = `../images/weatherIcon/${weatherImageName}.png`; 
      })();
    </script>
  </script>
</html>
